<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OmniTrack Framework</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: transparent;
            color: #1e2b4d;
            padding: 8px;
        }

        .root {
            max-width: 1600px;
            margin: 0 auto;
            min-width: 980px;
        }

        .top-grid {
            display: grid;
            grid-template-columns: 454fr 553fr;
            gap: 12px;
            align-items: start;
            margin-bottom: 10px;
            position: relative;
        }

        .rollout-link {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
            overflow: visible;
            opacity: 1;
            transition: opacity 0.25s ease;
        }

        .top-grid.hide-rollout .rollout-link {
            opacity: 0;
        }

        .rollout-path {
            stroke-dasharray: 9 7;
            animation: rolloutDash 1.1s linear infinite, rolloutGlow 1.6s ease-in-out infinite;
        }

        .rollout-label {
            animation: rolloutGlow 1.6s ease-in-out infinite;
        }

        @keyframes rolloutDash {
            from { stroke-dashoffset: 0; }
            to { stroke-dashoffset: -32; }
        }

        @keyframes rolloutGlow {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .flip-card {
            position: relative;
            perspective: 1400px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(30, 45, 80, 0.14);
            border: 1px solid rgba(140, 154, 192, 0.25);
            background: #fff;
        }

        .pmg-card { aspect-ratio: 454 / 333; }
        .gmt-card { aspect-ratio: 553 / 335; }

        .flip-inner {
            position: absolute;
            inset: 0;
            transform-style: preserve-3d;
            transition: transform 0.72s cubic-bezier(0.2, 0.7, 0.2, 1);
        }

        .flip-card:hover .flip-inner,
        .flip-card.active .flip-inner {
            transform: rotateY(180deg);
        }

        .face {
            position: absolute;
            inset: 0;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
        }

        .face img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        .face.back {
            transform: rotateY(180deg);
            background: linear-gradient(145deg, #1d2740, #293656);
            color: #e7eeff;
            padding: 20px;
            align-items: stretch;
        }

        .back-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 10px;
        }

        .back-content h3 {
            font-size: 1.4rem;
            color: #cdd9ff;
        }

        .back-content p {
            font-size: 0.96rem;
            line-height: 1.6;
            color: #dbe6ff;
        }

        .hint {
            position: absolute;
            right: 10px;
            bottom: 8px;
            font-size: 0.72rem;
            color: #5f6f96;
            background: rgba(255, 255, 255, 0.86);
            border: 1px solid rgba(148, 161, 191, 0.32);
            border-radius: 999px;
            padding: 3px 8px;
        }

        .app-wrap {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(30, 45, 80, 0.12);
            border: 1px solid rgba(140, 154, 192, 0.22);
            background: #fff;
            aspect-ratio: 1015 / 163;
        }

        .app-wrap img {
            width: 100%;
            height: auto;
            display: block;
        }

    </style>
</head>
<body>
    <div class="root" id="framework-root">
        <div class="top-grid">
            <article class="flip-card pmg-card top-module" tabindex="0" aria-label="Physical Motion Generation Module">
                <div class="flip-inner">
                    <div class="face front">
                        <img src="figures/pmg.svg" alt="Physical Motion Generation">
                        <span class="hint">Hover to flip</span>
                    </div>
                    <div class="face back">
                        <div class="back-content">
                            <h3>Physical Motion Generation</h3>
                            <p>This module learns a privileged generalist policy in simulation to transform noisy, artifact-heavy references into physically plausible motions.</p>
                            <p>It enforces robot dynamics consistency and produces stable intermediate motion commands for downstream tracking.</p>
                        </div>
                    </div>
                </div>
            </article>

            <article class="flip-card gmt-card top-module" tabindex="0" aria-label="General Motion Tracking Module">
                <div class="flip-inner">
                    <div class="face front">
                        <img src="figures/gmt.svg" alt="General Motion Tracking">
                        <span class="hint">Hover to flip</span>
                    </div>
                    <div class="face back">
                        <div class="back-content">
                            <h3>General Motion Tracking</h3>
                            <p>This module trains the general control policy to track physically plausible references under domain randomization and sensor noise.</p>
                            <p>The resulting policy outputs robust actions for long-horizon and dynamic real-world humanoid motion tracking.</p>
                        </div>
                    </div>
                </div>
            </article>

            <svg class="rollout-link" viewBox="0 0 1000 340" preserveAspectRatio="none" aria-hidden="true">
                <defs>
                    <!-- Arrow size tuning:
                         markerWidth/markerHeight changes head size.
                         polygon points should track those values. -->
                    <marker id="arrowhead-rollout" markerWidth="4" markerHeight="2.5" refX="2" refY="1.25" orient="auto" markerUnits="strokeWidth">
                        <polygon points="0 0, 4 1.25, 0 2.5" fill="#767171"></polygon>
                    </marker>
                </defs>
                <!--
                    Position tuning:
                    1) Edit polyline points to move the bent arrow.
                    2) Edit rollout-label x/y to move the text box.
                    Current path: from PMG right side -> right -> down -> right to GMT.
                -->
                <polyline class="rollout-path"
                    points="396,105 435,105 435,55 468,55"
                    fill="none"
                    stroke="#767171"
                    stroke-width="3.8"
                    marker-end="url(#arrowhead-rollout)">
                </polyline>
                <g class="rollout-label" transform="translate(400 110)">
                    <text x="0" y="0" text-anchor="start" dominant-baseline="hanging" font-size="14" font-weight="700" fill="#4A567A">Rollout</text>
                </g>
            </svg>
        </div>

        <article class="flip-card app-wrap" tabindex="0" aria-label="Application Inference Pipeline">
            <div class="flip-inner">
                <div class="face front">
                    <img src="figures/app.svg" alt="Application and Inference Example">
                    <span class="hint">Hover to flip</span>
                </div>
                <div class="face back">
                    <div class="back-content">
                        <h3>Application / Inference</h3>
                        <p>OmniTrack forms a two-stage pipeline for both offline and online use: the physical motion generation stage filters one or multiple motion clips via simulator rollouts to produce physically feasible, dynamics-consistent trajectories, and the general motion tracking stage delivers stable long-horizon tracking across diverse behaviors.</p>
                        <p>For online inference, real-time commands from mocap, VR headsets, or other sources are first refined in simulation (e.g., IsaacLab or MuJoCo) and then fed to the tracking policy for joint-level real-robot control, enabling robust, high-dynamic teleoperation under continuously varying user input.</p>
                    </div>
                </div>
            </div>
        </article>
    </div>

    <script>
        function notifyParentHeight() {
            if (window.parent === window) return;
            const root = document.getElementById("framework-root");
            if (!root) return;
            const h = Math.ceil(root.getBoundingClientRect().height + 20);
            window.parent.postMessage({ type: "method-height", height: h }, "*");
        }

        window.addEventListener("load", () => {
            notifyParentHeight();
            setTimeout(notifyParentHeight, 120);
            setTimeout(notifyParentHeight, 450);
            setTimeout(notifyParentHeight, 900);
        });

        window.addEventListener("resize", notifyParentHeight);

        if ("ResizeObserver" in window) {
            const ro = new ResizeObserver(() => notifyParentHeight());
            ro.observe(document.getElementById("framework-root"));
        }

        const allCards = Array.from(document.querySelectorAll(".flip-card"));
        const topGrid = document.querySelector(".top-grid");
        const topCards = Array.from(document.querySelectorAll(".top-module"));

        function updateRolloutVisibility() {
            const shouldHide = topCards.some((card) =>
                card.classList.contains("active") ||
                card.matches(":hover") ||
                card.matches(":focus-within")
            );
            topGrid.classList.toggle("hide-rollout", shouldHide);
        }

        allCards.forEach((card) => {
            card.addEventListener("click", () => {
                card.classList.toggle("active");
                updateRolloutVisibility();
                setTimeout(notifyParentHeight, 50);
            });
            card.addEventListener("keydown", (e) => {
                if (e.key === "Enter" || e.key === " ") {
                    e.preventDefault();
                    card.classList.toggle("active");
                    updateRolloutVisibility();
                    setTimeout(notifyParentHeight, 50);
                }
            });
        });

        topCards.forEach((card) => {
            card.addEventListener("mouseenter", updateRolloutVisibility);
            card.addEventListener("mouseleave", updateRolloutVisibility);
            card.addEventListener("focusin", updateRolloutVisibility);
            card.addEventListener("focusout", updateRolloutVisibility);
        });

        updateRolloutVisibility();
    </script>
</body>
</html>
